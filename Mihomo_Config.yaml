# BASE: https://github.com/Repcz/Tool/blob/X/Clash/Meta/Mihomo.yaml
#
# åŸºäº Repcz/Tool é¡¹ç›®ä¿®æ”¹
#
# å®˜æ–¹æ–‡æ¡£ï¼šhttps://wiki.metacubex.one/
#
# ä»¥ '#' æˆ– '//' å¼€å¤´çš„é…ç½®æ–‡ä»¶è¡Œä¸ºæ³¨é‡Šè¡Œ
#
# Mihomo Version â‰¥ 1.8.4
#
# æœ€åæ›´æ–°æ—¶é—´: 2024-11-17 

# è®¢é˜…æ›´æ–°å’Œå»¶è¿Ÿæµ‹è¯•ç›¸å…³å‚æ•°
p: &p {type: http, interval: 86400, health-check: {enable: true, url: http://www.gstatic.com/generate_204, interval: 1800}}
# ä»£ç†æä¾›å•†é…ç½®
proxy-providers:
  Subscribe1: {<<: *p, path: ./proxy-providers/Sub1.yaml, url: " "}
    # åœ¨æ­¤å°†" "æ›¿æ¢ä¸ºä½ çš„æœºåœºè®¢é˜…ï¼Œæ¨èä½¿ç”¨base64æˆ–è€…node list
    # Sub-Storeç”Ÿæˆçš„é“¾æ¥,å¯ä»¥ç›´æ¥æ›¿æ¢ä¸Šè¿°urlå¼•å·ä¸­çš„éƒ¨åˆ†,å…·ä½“è§Sub-Storeæ•™ç¨‹        
  #Subscribe2: {<<: *p, path: ./proxy-providers/Sub2.yaml, url: " "}
  #Subscribe3: {<<: *p, path: ./proxy-providers/Sub3.yaml, url: " "}
  #Subscribe4: {<<: *p, path: ./proxy-providers/Sub4.yaml, url: " "}

#------------------------åŸºç¡€é…ç½®------------------------#
mixed-port: 7890            # æ··åˆç«¯å£ï¼šHTTP(S)å’ŒSOCKS5å…±ç”¨ç«¯å£
tcp-concurrent: true        # TCPå¹¶å‘ï¼šå…è®¸å¹¶å‘è¿æ¥TCP,æé«˜å¹¶å‘æ€§èƒ½
unified-delay: true         # ç»Ÿä¸€å»¶è¿Ÿï¼šç»Ÿä¸€æ˜¾ç¤ºèŠ‚ç‚¹å»¶è¿Ÿ
allow-lan: true            # å±€åŸŸç½‘è¿æ¥ï¼šå…è®¸å…¶ä»–è®¾å¤‡ç»è¿‡æœ¬æœºä»£ç†
bind-address: "*"          # ç›‘å¬åœ°å€ï¼š*è¡¨ç¤ºç»‘å®šæ‰€æœ‰IPåœ°å€
find-process-mode: strict  # è¿›ç¨‹åŒ¹é…æ¨¡å¼ï¼šstrictä¸¥æ ¼,offå…³é—­,alwaysæ€»æ˜¯
ipv6: false               # IPv6å¼€å…³ï¼šæ˜¯å¦å¯ç”¨IPv6æ”¯æŒ

# è¿è¡Œæ¨¡å¼(ä»»é€‰å…¶ä¸€):
# rule: è§„åˆ™æ¨¡å¼ - æ ¹æ®è§„åˆ™åŒ¹é…æ¥é€‰æ‹©ä»£ç†
# global: å…¨å±€æ¨¡å¼ - å…¨éƒ¨æµé‡èµ°ä»£ç†
# direct: ç›´è¿æ¨¡å¼ - å…¨éƒ¨æµé‡ä¸èµ°ä»£ç†
mode: rule

# æ—¥å¿—ç­‰çº§(æŒ‰è¯¦ç»†ç¨‹åº¦æ’åº):
# debug: è°ƒè¯•
# info: ä¿¡æ¯
# warning: è­¦å‘Š
# error: é”™è¯¯
# silent: é™é»˜
log-level: info

geodata-mode: true          # GEOæ¨¡å¼ï¼štrueä½¿ç”¨geoip.datæ•°æ®åº“,falseä½¿ç”¨mmdbæ•°æ®åº“
geox-url:
  geoip: "https://mirror.ghproxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip-lite.dat"
  geosite: "https://mirror.ghproxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat"
  mmdb: "https://mirror.ghproxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country-lite.mmdb"
  asn: "https://mirror.ghproxy.com/https://github.com/xishang0128/geoip/releases/download/latest/GeoLite2-ASN.mmdb"

# å¤–éƒ¨æ§åˆ¶è®¾ç½®
external-controller: 0.0.0.0:9090  # å¤–éƒ¨æ§åˆ¶å™¨ç›‘å¬åœ°å€
# external-ui: folder               # å¤–éƒ¨æ§åˆ¶å™¨UIç›®å½•
# secret: ""                        # å¤–éƒ¨æ§åˆ¶å™¨å¯†ç 

profile:
  store-selected: true 
  store-fake-ip: true  

#å—…æ¢ enable: false å…³é—­ï¼Œå¼€å¯è¯·ä¿®æ”¹
sniffer:
  enable: false
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  force-domain:
    - "+.v2ex.com"
  skip-domain:
    - "Mijia Cloud"
    - "dlg.io.mi.com"
    - "+.push.apple.com"
    - "+.apple.com"

#------------------------DNS é…ç½®------------------------#
dns:
  cache-algorithm: arc
  enable: true
  prefer-h3: true
  listen: 0.0.0.0:53
  ipv6: true
  respect-rules: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - "+.lan"
    - "connect.rom.miui.com"
    - "+.miwifi.com"
    - "+.ntp.org"
    - "+.u-tools.cn"
    - "+.mediatek.com"
    - "+.cfprefer1.xyz"
    - "+.wetab.link"
    # QQ
    - "localhost.ptlogin2.qq.com"
    - "localhost.sec.qq.com"
    # WeChat
    - "localhost.work.weixin.qq.com"
    - "+.weixin.qq.com"
    - "+.wechat.com"
    # Windows
    - "time.windows.com"
    - "+.msftconnecttest.com"
    - "+.msftncsi.com"
    - "+.wpsmail.net"
    - "+.henzanapp.com"
    - "+.pconline.com.cn"
  proxy-server-nameserver:
    - 1.1.1.1
  nameserver:
    - 119.29.29.29
    - 8.8.8.8

###å»ºç«‹é”šç‚¹
    
# ç­–ç•¥ç»„å¼•ç”¨ç›¸å…³å‚æ•°
pg: &pg {type: select, proxies: [ğŸš€ èŠ‚ç‚¹é€‰æ‹©, ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹, ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹,  ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹, â™»ï¸ è‡ªåŠ¨é€‰æ‹©, DIRECT]}

# è‡ªåŠ¨é€‰æ‹©ç­–ç•¥ç»„ï¼šé€‰å–å»¶è¿Ÿæœ€ä½èŠ‚ç‚¹
auto: &auto {type: url-test, url: https://www.gstatic.com/generate_204, interval: 300, tolerance: 50, include-all: true}

# æ‰‹åŠ¨é€‰æ‹©ç­–ç•¥ç»„ï¼šæ‰‹åŠ¨é€‰æ‹©æƒ³è¦çš„èŠ‚ç‚¹/ç­–ç•¥ç»„
select: &select {type: select, include-all: true}

# æ•…éšœå›é€€ç­–ç•¥ç»„ï¼šç­–ç•¥ç»„å°†æŒ‰é¡ºåºé€‰æ‹©ä½ åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªå¯ç”¨çš„èŠ‚ç‚¹
fallback: &fallback {type: fallback, url: http://www.gstatic.com/generate_204, interval: 300, include-all: true}

# è´Ÿè½½å‡è¡¡ç­–ç•¥ç»„ï¼šä¸åŒçš„è¯·æ±‚å°†ä½¿ç”¨ä¸åŒçš„ä»£ç†èŠ‚ç‚¹
load-balance: &load-balance {type: load-balance, strategy: consistent-hashing, url: http://www.gstatic.com/generate_204, interval: 300, include-all: true}

# classicalè§„åˆ™ç›¸å…³
c: &c {type: http, behavior: classical, interval: 86400}

# domainè§„åˆ™ç›¸å…³
d: &d {type: http, behavior: domain, interval: 86400}

# ipcidrè§„åˆ™ç›¸å…³
i: &i {type: http, behavior: ipcidr, interval: 86400}

###ç»“æŸ


proxy-groups:

  #åˆ†æµåˆ†ç»„

  - {name: ğŸš€ èŠ‚ç‚¹é€‰æ‹©, type: select, proxies: [ğŸš€ æ‰‹åŠ¨åˆ‡æ¢, â™»ï¸ è‡ªåŠ¨é€‰æ‹©,ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹, ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹, DIRECT]}

  - {name: ğŸš€ æ‰‹åŠ¨åˆ‡æ¢, <<: *select}

  - {name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©, <<: *auto}

  - {name: ğŸ§š AI, <<: *pg}

  - {name: ğŸ“² Telegram, <<: *pg}

  - {name: ğŸ“¹ Youtube, <<: *pg}

  - {name: ğŸ Netflix, <<: *pg}

  - {name: ğŸ“º Bahamut, type: select, proxies: [ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹, ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸš€ èŠ‚ç‚¹é€‰æ‹©, DIRECT]}

  - {name: ğŸ¬ Emby, <<: *pg}

  - {name: ğŸ“¼ Bilibili, type: select, proxies: [DIRECT, ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹,ğŸš€ èŠ‚ç‚¹é€‰æ‹©]}

  - {name: ğŸŒ å›½å¤–åª’ä½“, <<: *pg}

  - {name: â“‚ï¸ å¾®è½¯æœåŠ¡, <<: *pg}

  #- {name: ğŸ“¢ è°·æ­ŒFCM, <<: *pg}

  - {name: ğŸ è‹¹æœæœåŠ¡, <<: *pg}

  - {name: ğŸ® æ¸¸æˆå¹³å°, <<: *pg}

  - {name: ğŸ¯ å…¨çƒç›´è¿, type: select, proxies: [DIRECT, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]}

  - {name: ğŸŸ å…œåº•åˆ†æµ, <<: *pg}

  #èŠ‚ç‚¹åœ°åŒºåˆ†ç»„

  - {name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, <<: *auto, filter: "^(?=.*((?i)ğŸ‡­ğŸ‡°|é¦™æ¸¯|(\b(HK|Hong)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|(\b(GAME)\b))).*$"}

  - {name: ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹, <<: *auto, filter: "^(?=.*((?i)ğŸ‡ºğŸ‡¸|ç¾å›½|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|(\b(US|United States)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|(\b(GAME)\b))).*$"}

  - {name: ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹, <<: *auto, filter: "^(?=.*((?i)ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®|(\b(SG|Singapore)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|(\b(GAME)\b))).*$"}

  - {name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, <<: *auto, filter: "^(?=.*((?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|(\b(JP|Japan)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|(\b(GAME)\b))).*$"}

  - {name: ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹, <<: *auto, filter: "(?i)ğŸ‡¹ğŸ‡¼|å°æ¹¾|(\b(TW|Tai|Taiwan)\b)"}



# è§„åˆ™æä¾›å•†é…ç½® - ä¼˜åŒ–ç‰ˆ
rule-providers:

 # ç›´è¿
 Inside: {<<: *c, format: text, path: ./rule-providers/Inside.list,  url: https://raw.githubusercontent.com/cutethotw/ClashRule/main/Rule/Inside.list}
 LocalAreaNetwork: {<<: *c, format: text, path: ./rule-providers/LocalAreaNetwork.list,  url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/LocalAreaNetwork.list}
 UnBan: {<<: *c, format: text, path: ./rule-providers/UnBan.list,  url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/UnBan.list}

 # AIå¹³å°
 AI: {<<: *c, format: text, path: ./rule-providers/AI.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/AI.list}

 # å¾®è½¯æœåŠ¡ 
 #OneDrive: {<<: *c, format: text, path: ./rule-providers/OneDrive.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/OneDrive.list}
 #Github: {<<: *c, format: text, path: ./rule-providers/Github.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Github.list}
 Microsoft: {<<: *c, format: text, path: ./rule-providers/Microsoft.list,  url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Microsoft/Microsoft.list}

 # è°·æ­ŒFCM /CN
 GoogleFCM: {<<: *c, format: text, path: ./rule-providers/GoogleFCM.list,  url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/GoogleFCM.list}
 GoogleCN: {<<: *c, format: text, path: ./rule-providers/GoogleCN.list,  url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/GoogleCN.list}

 # è‹¹æœæœåŠ¡
 Apple: {<<: *c, format: text, path: ./rule-providers/Apple.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Apple.list}

 # ç”µæŠ¥æ¶ˆæ¯
 Telegram: {<<: *c, format: text, path: ./rule-providers/Telegram.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Telegram.list}

 # æ¸¸æˆä¸‹è½½
 SteamCN: {<<: *c, format: text, path: ./rule-providers/steamCN.list,  url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/SteamCN/SteamCN.list}

 # æ¸¸æˆå¹³å°
 Game: {<<: *c, format: text, path: ./rule-providers/Game.list,  url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Game/Game.list}

 # åª’ä½“
 YouTube: {<<: *c, format: text, path: ./rule-providers/YouTube.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/YouTube.list}
 Netflix: {<<: *c, format: text, path: ./rule-providers/Netflix.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Netflix.list}
 Emby: {<<: *c,format: text, path: ./rule-providers/Emby.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Emby.list}
 Bahamut: {<<: *c,format: text, path: ./rule-providers/Bahamut.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Bahamut.list}
 
 BilibiliHMT: {<<: *c, format: text, path: ./rule-providers/BilibiliHMT.list,  url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/BilibiliHMT.list}
 BiliBili: {<<: *c, format: text, path: ./rule-providers/BiliBili.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Bilibili.list}

 # å›½é™…åª’ä½“
 ProxyMedia: {<<: *c, format: text, path: ./rule-providers/ProxyMedia.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/ProxyMedia.list}

 # ä¸­å›½å¤§é™†
 ChinaDomain: {<<: *d, format: text, path: ./rule-providers/ChinaDomain.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/ChinaDomain.list}
 ChinaCompanyIp: {<<: *i, format: text, path: ./rule-providers/ChinaCompanyIp.list,  url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaCompanyIp.list}

 # ä¸‹è½½æœåŠ¡
 Download: {<<: *c, format: text, path: ./rule-providers/Download.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Download.list}

 # ä»£ç†ç½‘ç«™
 ProxyGFW: {<<: *c, format: text, path: ./rule-providers/ProxyGFW.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/ProxyGFW.list}
 


# è§„åˆ™é…ç½® 
rules:
  # ä¼˜å…ˆå¤„ç†
  - DOMAIN-SUFFIX,windowsupdate.com,DIRECT

  # æœ¬åœ°å±€åŸŸç½‘
  - DOMAIN-SUFFIX,local,DIRECT
  - DOMAIN-SUFFIX,localhost,DIRECT
  - IP-CIDR,127.0.0.0/8,DIRECT
  - IP-CIDR,172.16.0.0/12,DIRECT
  - IP-CIDR,192.168.0.0/16,DIRECT
  - IP-CIDR,10.0.0.0/8,DIRECT
  - IP-CIDR,17.0.0.0/8,DIRECT
  - IP-CIDR,100.64.0.0/10,DIRECT
  - IP-CIDR,224.0.0.0/4,DIRECT
  - IP-CIDR6,fe80::/10,DIRECT

  # åº”ç”¨åˆ†æµ
  - RULE-SET,Inside,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,LocalAreaNetwork,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,UnBan,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,AI,ğŸ§š AI
  - RULE-SET,Microsoft,â“‚ï¸ å¾®è½¯æœåŠ¡
  - RULE-SET,GoogleFCM,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,GoogleCN,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,Apple,ğŸ è‹¹æœæœåŠ¡
  - RULE-SET,Telegram,ğŸ“² Telegram
  - RULE-SET,SteamCN,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,Game,ğŸ® æ¸¸æˆå¹³å°
  - RULE-SET,YouTube,ğŸ“¹ Youtube
  - RULE-SET,Netflix,ğŸ Netflix
  - RULE-SET,Emby,ğŸ¬ Emby
  - RULE-SET,Bahamut,ğŸ“º Bahamut
  - RULE-SET,BilibiliHMT,ğŸ“¼ Bilibili
  - RULE-SET,BiliBili,ğŸ“¼ Bilibili
  - RULE-SET,ProxyMedia,ğŸŒ å›½å¤–åª’ä½“
  - RULE-SET,ProxyGFW,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - RULE-SET,ChinaDomain,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,ChinaCompanyIp,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,Download,ğŸ¯ å…¨çƒç›´è¿

  # è‡ªå®šä¹‰è§„åˆ™
  #- PROCESS-NAME,Thunder,DIRECT

  # åœ°åŸŸè§„åˆ™
  #- GEOIP,LAN,ğŸ¯ å…¨çƒç›´è¿
  - GEOIP,CN,ğŸ¯ å…¨çƒç›´è¿

  # å…œåº•è§„åˆ™
  - MATCH,ğŸŸ å…œåº•åˆ†æµ
